# åœ°å›¾APIæ¥å…¥æŒ‡å—

## ğŸ—ºï¸ æ¨èåœ°å›¾APIæä¾›å•†

åœ¨ä¸­å›½å¤§é™†ï¼Œæ¨èä½¿ç”¨ä»¥ä¸‹åœ°å›¾æœåŠ¡ï¼š

### 1. é«˜å¾·åœ°å›¾ (æ¨è) â­â­â­â­â­
- **ä¼˜åŠ¿**: å›½å†…ä½¿ç”¨æœ€å¹¿æ³›ï¼Œæ•°æ®å‡†ç¡®ï¼Œå…è´¹é¢åº¦å……è¶³
- **å®˜ç½‘**: https://lbs.amap.com/
- **å…è´¹é¢åº¦**: æ¯æ—¥30ä¸‡æ¬¡è°ƒç”¨ï¼ˆä¸ªäººå¼€å‘è€…ï¼‰

### 2. ç™¾åº¦åœ°å›¾
- **å®˜ç½‘**: https://lbsyun.baidu.com/
- **å…è´¹é¢åº¦**: æ¯æ—¥10ä¸‡æ¬¡è°ƒç”¨

### 3. è…¾è®¯åœ°å›¾
- **å®˜ç½‘**: https://lbs.qq.com/
- **å…è´¹é¢åº¦**: æ¯æ—¥10ä¸‡æ¬¡è°ƒç”¨

---

## ğŸ“ é«˜å¾·åœ°å›¾APIæ¥å…¥æ­¥éª¤ï¼ˆè¯¦ç»†æ•™ç¨‹ï¼‰

### ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œè´¦å·

1. è®¿é—®é«˜å¾·å¼€æ”¾å¹³å°ï¼šhttps://lbs.amap.com/
2. ç‚¹å‡»å³ä¸Šè§’"æ³¨å†Œ"æŒ‰é’®
3. å¡«å†™æ‰‹æœºå·ã€éªŒè¯ç å®Œæˆæ³¨å†Œ
4. ç™»å½•åè¿›å…¥æ§åˆ¶å°

### ç¬¬äºŒæ­¥ï¼šåˆ›å»ºåº”ç”¨

1. è¿›å…¥æ§åˆ¶å°åï¼Œç‚¹å‡»"åº”ç”¨ç®¡ç†" > "æˆ‘çš„åº”ç”¨"
2. ç‚¹å‡»"åˆ›å»ºæ–°åº”ç”¨"æŒ‰é’®
3. å¡«å†™åº”ç”¨ä¿¡æ¯ï¼š
   - **åº”ç”¨åç§°**: å†œåºŸå®å›æ”¶å¹³å°
   - **åº”ç”¨ç±»å‹**: Webç«¯ï¼ˆJS APIï¼‰
   - **åº”ç”¨ç®€ä»‹**: å†œä¸šåºŸå“å›æ”¶ç®¡ç†ç³»ç»Ÿ

### ç¬¬ä¸‰æ­¥ï¼šæ·»åŠ Key

1. åœ¨åˆ›å»ºçš„åº”ç”¨ä¸‹ï¼Œç‚¹å‡»"æ·»åŠ Key"
2. å¡«å†™Keyä¿¡æ¯ï¼š
   - **Keyåç§°**: å†œåºŸå®Webç«¯
   - **æœåŠ¡å¹³å°**: é€‰æ‹©"Webç«¯ï¼ˆJS APIï¼‰"
   - **åŸŸåç™½åå•**: 
     - å¼€å‘ç¯å¢ƒ: `localhost,127.0.0.1`
     - ç”Ÿäº§ç¯å¢ƒ: æ·»åŠ ä½ çš„å®é™…åŸŸå
3. ç‚¹å‡»"æäº¤"ï¼Œç³»ç»Ÿä¼šç”Ÿæˆä¸€ä¸ªKey

### ç¬¬å››æ­¥ï¼šè·å–Key

åˆ›å»ºæˆåŠŸåï¼Œä½ ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„Keyï¼š
```
YOUR_AMAP_KEY = "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6"
```

**âš ï¸ é‡è¦æç¤ºï¼šè¯·å¦¥å–„ä¿ç®¡ä½ çš„Keyï¼Œä¸è¦æ³„éœ²ç»™ä»–äººï¼**

---

## ğŸ”§ é…ç½®é¡¹ç›®ä½¿ç”¨åœ°å›¾API

### æ–¹æ³•1ï¼šç›´æ¥æ›¿æ¢Keyï¼ˆå¿«é€Ÿæµ‹è¯•ï¼‰

æ‰“å¼€ `farmer-nearby-recyclers.html` æ–‡ä»¶ï¼Œæ‰¾åˆ°ç¬¬241è¡Œï¼š

```html
<!-- é«˜å¾·åœ°å›¾API -->
<script src="https://webapi.amap.com/maps?v=2.0&key=ebfe63f863c9be121412d28f5dd60501&plugin=AMap.Driving"></script>
```

å°† `YOUR_AMAP_KEY` æ›¿æ¢ä¸ºä½ ç”³è¯·çš„å®é™…Keyï¼š

```html
<script src="https://webapi.amap.com/maps?v=2.0&key=a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6&plugin=AMap.Driving"></script>
```

### æ–¹æ³•2ï¼šä½¿ç”¨é…ç½®æ–‡ä»¶ï¼ˆæ¨èç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰

åˆ›å»º `config.js` æ–‡ä»¶ï¼š

```javascript
// config.js
const CONFIG = {
    AMAP_KEY: 'YOUR_AMAP_KEY',
    API_BASE: 'http://localhost:4000'
};
```

åœ¨HTMLä¸­å¼•å…¥ï¼š

```html
<script src="config.js"></script>
<script>
    // åŠ¨æ€åŠ è½½é«˜å¾·åœ°å›¾
    const script = document.createElement('script');
    script.src = `https://webapi.amap.com/maps?v=2.0&key=${CONFIG.AMAP_KEY}&plugin=AMap.Driving`;
    document.head.appendChild(script);
</script>
```

---

## ğŸ§ª æµ‹è¯•åœ°å›¾åŠŸèƒ½

### 1. æµ‹è¯•APIæ˜¯å¦æ­£å¸¸åŠ è½½

æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰ï¼Œè¾“å…¥ï¼š

```javascript
console.log(typeof AMap !== 'undefined' ? 'åœ°å›¾APIåŠ è½½æˆåŠŸ' : 'åœ°å›¾APIåŠ è½½å¤±è´¥');
```

### 2. æµ‹è¯•å®Œæ•´æµç¨‹

1. å¯åŠ¨åç«¯æœåŠ¡ï¼š
   ```bash
   node server.js
   ```

2. å¯åŠ¨å‰ç«¯æœåŠ¡ï¼š
   ```bash
   python3 -m http.server 8080
   ```

3. è®¿é—®é¡µé¢ï¼š
   ```
   http://127.0.0.1:8080/farmer-nearby-recyclers.html
   ```

4. éªŒè¯åŠŸèƒ½ï¼š
   - âœ… æ˜¯å¦è·å–åˆ°å½“å‰ä½ç½®
   - âœ… æ˜¯å¦æ˜¾ç¤ºé™„è¿‘çš„å¤„ç†ç‚¹
   - âœ… ç‚¹å‡»"æŸ¥çœ‹è·¯çº¿"æ˜¯å¦æ˜¾ç¤ºåœ°å›¾
   - âœ… åœ°å›¾æ˜¯å¦æ˜¾ç¤ºèµ·ç‚¹å’Œç»ˆç‚¹
   - âœ… æ˜¯å¦è§„åˆ’å‡ºé©¾è½¦è·¯çº¿

---

## ğŸ“± å¸¸è§é—®é¢˜è§£å†³

### Q1: åœ°å›¾ä¸æ˜¾ç¤ºï¼Œæ§åˆ¶å°æŠ¥é”™ "INVALID_USER_KEY"

**åŸå› **: API Key æ— æ•ˆæˆ–åŸŸåç™½åå•ä¸åŒ¹é…

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥Keyæ˜¯å¦æ­£ç¡®å¤åˆ¶
2. ç¡®è®¤åŸŸåç™½åå•ä¸­åŒ…å« `localhost` å’Œ `127.0.0.1`
3. ç­‰å¾…5-10åˆ†é’Ÿï¼Œæ–°åˆ›å»ºçš„Keyéœ€è¦æ—¶é—´ç”Ÿæ•ˆ

### Q2: æ— æ³•è·å–ç”¨æˆ·ä½ç½®

**åŸå› **: æµè§ˆå™¨å®‰å…¨ç­–ç•¥é™åˆ¶

**è§£å†³æ–¹æ¡ˆ**:
1. ä½¿ç”¨ HTTPS æˆ– localhostï¼ˆHTTPä¹Ÿå¯ä»¥ï¼‰
2. åœ¨æµè§ˆå™¨ä¸­å…è®¸ä½ç½®è®¿é—®æƒé™
3. å¦‚æœä»å¤±è´¥ï¼Œä»£ç ä¼šè‡ªåŠ¨ä½¿ç”¨é»˜è®¤ä½ç½®ï¼ˆåŒ—äº¬ï¼‰

### Q3: è·¯çº¿è§„åˆ’å¤±è´¥

**åŸå› **: èµ·ç‚¹æˆ–ç»ˆç‚¹åæ ‡ä¸æ­£ç¡®

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥æ•°æ®åº“ä¸­å›æ”¶å•†çš„ç»çº¬åº¦æ˜¯å¦æ­£ç¡®
2. ç¡®ä¿åæ ‡æ ¼å¼ä¸ºï¼šç»åº¦åœ¨å‰ï¼Œçº¬åº¦åœ¨å
3. æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

### Q4: åœ°å›¾åŠ è½½å¾ˆæ…¢

**åŸå› **: ç½‘ç»œé—®é¢˜æˆ–APIè°ƒç”¨é‡è¿‡å¤§

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. ä½¿ç”¨CDNåŠ é€Ÿ
3. è€ƒè™‘ç¼“å­˜åœ°å›¾èµ„æº

---

## ğŸš€ é«˜çº§åŠŸèƒ½æ‰©å±•

### 1. æ·»åŠ å¤šç§è·¯çº¿è§„åˆ’æ–¹å¼

```javascript
// æ­¥è¡Œè·¯çº¿
const walking = new AMap.Walking({ map: map });

// å…¬äº¤è·¯çº¿
const transfer = new AMap.Transfer({ map: map });

// éª‘è¡Œè·¯çº¿
const riding = new AMap.Riding({ map: map });
```

### 2. æ·»åŠ å®æ—¶è·¯å†µ

```javascript
const trafficLayer = new AMap.TileLayer.Traffic({
    zIndex: 10
});
map.add(trafficLayer);
```

### 3. æ·»åŠ æœç´¢åŠŸèƒ½

```javascript
AMap.plugin('AMap.Autocomplete', function() {
    const autoComplete = new AMap.Autocomplete({
        input: 'search-input'
    });
});
```

### 4. æ·»åŠ å‘¨è¾¹æœç´¢

```javascript
AMap.plugin('AMap.PlaceSearch', function() {
    const placeSearch = new AMap.PlaceSearch({
        type: 'é¤é¥®æœåŠ¡',
        pageSize: 10,
        pageIndex: 1
    });
});
```

---

## ğŸ“Š APIä½¿ç”¨ç»Ÿè®¡

ç™»å½•é«˜å¾·å¼€æ”¾å¹³å°æ§åˆ¶å°ï¼Œå¯ä»¥æŸ¥çœ‹ï¼š
- æ¯æ—¥è°ƒç”¨é‡
- è°ƒç”¨æˆåŠŸç‡
- è°ƒç”¨åˆ†å¸ƒå›¾
- å¼‚å¸¸ç»Ÿè®¡

å»ºè®®å®šæœŸæ£€æŸ¥ï¼Œé¿å…è¶…å‡ºå…è´¹é¢åº¦ã€‚

---

## ğŸ”’ å®‰å…¨å»ºè®®

### ç”Ÿäº§ç¯å¢ƒé…ç½®

1. **åŸŸåç™½åå•**: åªæ·»åŠ å®é™…ä½¿ç”¨çš„åŸŸå
2. **Refereræ ¡éªŒ**: å¯ç”¨æ¥æºæ ¡éªŒ
3. **ä½¿ç”¨ä»£ç†**: ä¸è¦åœ¨å‰ç«¯æš´éœ²Keyï¼Œé€šè¿‡åç«¯ä»£ç†è¯·æ±‚

### åç«¯ä»£ç†ç¤ºä¾‹

åœ¨ `server.js` ä¸­æ·»åŠ ï¼š

```javascript
app.get('/api/map/route', async (req, res) => {
    const { origin, destination } = req.query;
    const url = `https://restapi.amap.com/v3/direction/driving?origin=${origin}&destination=${destination}&key=${AMAP_SERVER_KEY}`;
    
    try {
        const response = await fetch(url);
        const data = await response.json();
        res.json(data);
    } catch (error) {
        res.status(500).json({ error: error.message });
    }
});
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [é«˜å¾·åœ°å›¾JS APIæ–‡æ¡£](https://lbs.amap.com/api/javascript-api/summary)
- [è·¯çº¿è§„åˆ’API](https://lbs.amap.com/api/javascript-api/reference/route-search)
- [åæ ‡æ‹¾å–å·¥å…·](https://lbs.amap.com/tools/picker)
- [ç¤ºä¾‹ä»£ç ä¸­å¿ƒ](https://lbs.amap.com/demo/javascript-api/example/map/map-show)

---

## ğŸ’¡ æ›¿ä»£æ–¹æ¡ˆï¼ˆå¦‚æœæš‚æ—¶æ²¡æœ‰API Keyï¼‰

### ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®æµ‹è¯•

åœ¨ `farmer-nearby-recyclers.html` ä¸­ï¼Œä¸´æ—¶ç¦ç”¨åœ°å›¾åŠ è½½ï¼š

```javascript
function initMap(destination) {
    // æš‚æ—¶æ˜¾ç¤ºé™æ€ä¿¡æ¯
    document.getElementById('route-info').innerHTML = `
        <h3>è·¯çº¿ä¿¡æ¯ï¼ˆæ¨¡æ‹Ÿï¼‰</h3>
        <p>èµ·ç‚¹ï¼šæ‚¨çš„ä½ç½®</p>
        <p>ç»ˆç‚¹ï¼š${destination.name}</p>
        <p>è·ç¦»ï¼š${destination.distance} km</p>
        <p>é¢„è®¡æ—¶é—´ï¼š${Math.ceil(destination.distance / 40 * 60)} åˆ†é’Ÿ</p>
        <p style="color: #e74c3c; margin-top: 10px;">
            âš ï¸ è¯·é…ç½®é«˜å¾·åœ°å›¾API Keyä»¥æŸ¥çœ‹çœŸå®åœ°å›¾å’Œè·¯çº¿
        </p>
    `;
}
```

è¿™æ ·å³ä½¿æ²¡æœ‰é…ç½®API Keyï¼Œé¡µé¢çš„å…¶ä»–åŠŸèƒ½ï¼ˆæ˜¾ç¤ºé™„è¿‘å¤„ç†ç‚¹ã€æ‹¨æ‰“ç”µè¯ï¼‰ä»ç„¶å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚

---

## âœ… å®Œæˆæ£€æŸ¥æ¸…å•

- [ ] æ³¨å†Œé«˜å¾·å¼€æ”¾å¹³å°è´¦å·
- [ ] åˆ›å»ºåº”ç”¨å¹¶è·å–API Key
- [ ] é…ç½®åŸŸåç™½åå•ï¼ˆlocalhost, 127.0.0.1ï¼‰
- [ ] æ›¿æ¢HTMLä¸­çš„YOUR_AMAP_KEY
- [ ] æµ‹è¯•åœ°å›¾æ˜¯å¦æ­£å¸¸åŠ è½½
- [ ] æµ‹è¯•è·¯çº¿è§„åˆ’åŠŸèƒ½
- [ ] æ£€æŸ¥æ•°æ®åº“ä¸­å›æ”¶å•†çš„ä½ç½®æ•°æ®
- [ ] æµ‹è¯•åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šçš„è¡¨ç°

---

**ç¥æ‚¨æ¥å…¥é¡ºåˆ©ï¼å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒé«˜å¾·åœ°å›¾å®˜æ–¹æ–‡æ¡£æˆ–è”ç³»æŠ€æœ¯æ”¯æŒã€‚** ğŸ‰
